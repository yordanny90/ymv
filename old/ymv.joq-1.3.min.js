/*
 * JavaScript Object Query
 * ymv.joq v1.3
 * Fecha: 20161121
 * Autor: Yordanny Mej√≠as V. yordanny90@gmail.com
 */
$joq=function(a){return a=function(b){return this.constructor!=a?new a(b):void(this.o=b)},a.each=function(a,b){for(var c in a)b(c,a[c],a)},a.serialize=function(b,c){var d=[];return void 0!=b&&("string"==typeof b||"number"==typeof b||"boolean"==typeof b||"object"==typeof b&&b.constructor==File?d.push({name:c,value:b}):"object"==typeof b&&a.each(b,function(b,e){d=d.concat(a.serialize(e,c?c+"["+b+"]":b))})),d},a.fn=a.prototype,a.fn.serialize=function(b){return a.serialize(this.val(),b)},a.fn.deserialize=function(b){var c=this;return a.each(b,function(a,b){b&&"object"==typeof b&&"string"==typeof b.name&&("[]"==b.name.substring(b.name.length-2)?c.add(b.name.substring(0,b.name.length-2).replace(/\]/g,""),b.value,"["):c.set(b.name.replace(/\]/g,""),b.value,"["))}),this},a.fn.val=function(){return this.o},a.fn.get=function(b,c){var d=this.val();return"string"!=typeof c&&(c="."),a.each(b.split(c),function(a,b){d=d&&"object"==typeof d?d[b]:void 0}),d},a.fn.add=function(b,c,d){var e=this.val();"string"!=typeof d&&(d=".");var f=b.split(d);return a.each(f,function(a,b){e&&(f.length-1==a?("undefined"!=typeof e[b]&&null!=e[b]||(e[b]=[]),"object"==typeof e[b]&&e[b].constructor==Array&&e[b].push(c)):e[b]||(e[b]={}),e=e[b])}),this},a.fn.set=function(b,c,d){var e=this.val();"string"!=typeof d&&(d=".");var f=b.split(d);return a.each(f,function(a,b){e&&(f.length-1==a?e[b]=c:e[b]||(e[b]={}),e=e[b])}),this},a.fn.unset=function(b,c){var d=this.val();"string"!=typeof c&&(c=".");var e=b.split(c),f=!1;return a.each(e,function(a,b){d&&(e.length-1==a&&(delete d[b],f=!0),d=d[b])}),f},a.fn.valueAsIndex=function(){return this.select(function(a,b){return a[b]},function(a,b){return b})},a.fn.select=function(b,c,d){var e=this.val();"function"!=typeof d&&(d=function(){return!0}),"function"!=typeof c&&(c=function(a,b){return a[b]}),"function"!=typeof b&&(b=function(a,b){return b});var f=new Object;return a.each(e,function(a){d(e,a)&&(f[b(e,a)]=c(e,a))}),a(f)},a.fn.selectDefined=function(a,b,c){return"function"!=typeof c&&(c=function(){return!0}),this.select(a,b,function(a,b){return"undefined"!=typeof a[b]&&c(a,b)})},a.fn.selectUndefined=function(a,b,c){return"function"!=typeof c&&(c=function(){return!0}),this.select(a,b,function(a,b){return"undefined"==typeof a[b]&&c(a,b)})},a.fn.update=function(b,c,d,e){if(!b||"object"!=typeof b)return this;var f=this.val();if(b.constructor==a)var g=b.val();else var g=b;return"function"!=typeof e&&(e=function(a,b,c){return"undefined"!=typeof b[c]}),"function"!=typeof d&&(d=function(a,b,c){return b[c]}),"function"!=typeof c&&(c=function(a,b,c){return c}),a.each(f,function(a){e(f,g,a)&&(f[c(f,g,a)]=d(f,g,a))}),this},a.fn.insert=function(b,c,d,e){if(!b||"object"!=typeof b)return this;var f=this.val();if(b.constructor==a)var g=b.val();else var g=b;return"function"!=typeof e&&(e=function(){return!0}),"function"!=typeof d&&(d=function(a,b,c){return b[c]}),"function"!=typeof c&&(c=function(a,b,c){return c}),a.each(g,function(a){"undefined"==typeof f[a]&&e(f,g,a)&&(f[c(f,g,a)]=d(f,g,a))}),this},a.fn.delete=function(b,c,d){if(!b||"object"!=typeof b)return this;var e=this.val();if(b.constructor==a)var f=b.val();else var f=b;return"function"!=typeof d&&(d=function(){return!0}),"function"!=typeof c&&(c=function(a,b,c){return c}),a.each(f,function(a){d(e,f,a)&&delete e[c(e,f,a)]}),this},a.fn.merge=function(b,c,d,e){if(!b||"object"!=typeof b)return this;var f=this.val();if(b.constructor==a)var g=b.val();else var g=b;return"function"!=typeof e&&(e=function(a,b,c){return"undefined"!=typeof b[c]}),"function"!=typeof d&&(d=function(a,b,c){return b[c]}),"function"!=typeof c&&(c=function(a,b,c){return c}),a.each(g,function(a){e(f,g,a)&&(f[c(f,g,a)]=d(f,g,a))}),this},a}();
